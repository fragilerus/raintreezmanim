<!DOCTYPE html>
<html>
    <head>
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <style>
            .table td{
                text-align: center;
            }
            .table tfoot td{
                text-align: right;
            }
            .table tbody td:first-child{
                font-weight: bold;
            }
        </style>
    </head>
    <body>
        <h2 class="text-center">Zmanei Tefilah In Raintree & Nearby Areas</h2>
        <table id="zmanim" class="table table-striped table-bordered">
            <thead>
                <tr></tr>
            </thead>
            <tbody>
            </tbody>
            <tfoot>
                <tr><td colspan="1000" class="small"></td></tr>
            </tfoot>
        </table>
        <script>
            function generateRow(headers, object){
                var row = '<tr>';
                for(var i = 0; i < headers.length;){
                    var value = object[headers[i]];
                    var colspan = 1;
                    while(value === object[headers[++i]]){
                        colspan++;
                    }
                    row += '<td' + (colspan > 1 ? (' colspan="' + colspan + '">') : '>') + value + '</td>';
                }
                return row + '</tr>';
            }
            function populateTable(table,objects, lastUpdate){
                var headers = Object.keys(objects[0]);
                table.querySelector('thead tr').innerHTML = headers.map(function(h){ return '<th>' + h + '</th>';}).join('\n');
                table.querySelector('tbody').innerHTML = objects.map(generateRow.bind(null,headers)).join('\n');
                table.querySelector('tfoot td').innerText = 'Last updated: ' + lastUpdate.toLocaleDateString();
            }
            function loadTable(){
                if(ajax.readyState !== XMLHttpRequest.DONE || ajax.status !== 200) return;
                var data = JSON.parse(ajax.responseText);
                populateTable(document.getElementById('zmanim'),data.data, new Date(data.lastUpdated));
            }
            var ajax = new XMLHttpRequest();
            ajax.onreadystatechange = loadTable;
            ajax.open('GET', 'https://script.google.com/macros/s/AKfycbzxKV-iDLr8oOYtnRPcUSeGTFIDf-tbf83Qx9XJpJLQSaLTtZ8/exec');
            ajax.send();
        </script>
    </body>
</html>